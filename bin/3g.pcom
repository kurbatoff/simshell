
;;
;; file name: 01_3G_test006_USIM_map_CHV.pcom
;;

.ALLUNDEFINE 

.DEFINE %IMSI           082955000000000000
.DEFINE %KI             AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 007E
.DEFINE %OPC            AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 007E
.DEFINE %ALGO 30


.DEFINE %PIN_AC 55F5FF

.DEFINE %EF_0001 0001
.DEFINE %EF_0010 0010
.DEFINE %EF_0011 0011
.DEFINE %EF_0012 0012

.DEFINE %OP_TYPE	01
.DEFINE %OP_R1	40
.DEFINE %OP_R2	00
.DEFINE %OP_R3	20
.DEFINE %OP_R4	40
.DEFINE %OP_R5	60
.DEFINE %OP_C1	00000000000000000000000000000000
.DEFINE %OP_C2	00000000000000000000000000000001
.DEFINE %OP_C3	00000000000000000000000000000002
.DEFINE %OP_C4	00000000000000000000000000000004
.DEFINE %OP_C5	00000000000000000000000000000008

.DEFINE %SFI_EF_6F78 06 ;; Access control class
.DEFINE %SFI_EF_6F7E 0B ;; Location information
.DEFINE %SFI_EF_6F73 0C ;; Packet switched location information
.DEFINE %SFI_EF_6F7B 0D ;; Forbidden PLMNs


.DEFINE %PIN1 30303030 FFFFFFFF
.DEFINE %PIN2 32323232 FFFFFFFF

.DEFINE %GPIN 31323334FFFFFFFF
.DEFINE %LPIN 30303030FFFFFFFF
.DEFINE %ADM  528EFE76503B15DB

.INSERT
.POWER_ON

A024 0000 10 11111111 11111111 %ADM
A020 0000 08 528EFE76 503B15DB (9000)

;; read flash mem: default ADM code [if erased already]
A0B8 0004 80 (9000)

A0B8 0000 20 (9000)

;; format EEPROM i.e. erase card
A0A0 0000 00 (9000)
.POWER_OFF

.POWER_ON
A020 0000 08 528EFE76 503B15DB (90XX)

A0B8 0000 80 [DECAFFED] (9000)

;; read flash mem: default ADM code
A0B8 0004 80 [528EFE76 503B15DB] (9000)

;; create MF
A0E0000120 0000 0008 3F00 1000 000000 911300010000 0F55FF 2F0601000000000000000000 (9000)

A0A4 0000 02 3F00 (9F22)
A0C0 0000 22 [0000 XXXX 3F000100 0F55FF0115B10000 050000000000008A 0000000000000000 00] (9000)

;; --- 1 ---------------------------------------------------------------------------
;; EF_CHV
A0E0 0001 20 0004 0005 %EF_0001 0100 000000 1113DC01000D %PIN_AC 2F060100 0000000000000000 (9000)

A0E2 0000 0D 00 528EFE76503B15DB AA80 C324 (9000) ;; ADM0
A0E2 0000 0D 03 31323334FFFFFFFF 3380 D53D (9000) ;; PIN1
A0E2 0000 0D 04 32323232FFFFFFFF 3380 ABB9 (9000) ;; PIN2
A0E2 0000 0D 00 3132333435363738 AA80 3942 (9000) ;; PUK1
A0E2 0000 0D 00 3232323232323232 AA80 54B8 (9000) ;; PUK2

;; --- 2 ---------------------------------------------------------------------------
;; EF_ADM
A0E0 0001 20 0004 0001 %EF_0010 0100 000000 1113DC01000D %PIN_AC 2F060200 0000000000000000 (9000)
A0E2 0000 0D 00 528EFE76503B15DB AA80 C324 (9000)

;; --- 3 ---------------------------------------------------------------------------
;; EF GLOBAL PIN
A0E0 0001 20 000D 0006 %EF_0011 01000000000100DF00000D %PIN_AC 2F060200 0000000000000000 (9000)
A0E2 0000 0D 02303030303030303033007C93 (9000) ;; UNIVERSAL PIN
A0E2 0000 0D 023030303030303030AA00DEE0 (9000) ;; UNIVERSAL PUK
A0E2 0000 0D 0430303030FFFFFFFF33805C11 (9000) ;; GLOBAL PIN
A0E2 0000 0D 044567FFFFFFFFFFFFAA807070 (9000) ;; GLOBAL PUK
A0E2 0000 0D 0631313131FFFFFFFF33808776 (9000) ;; GLOBAL PIN
A0E2 0000 0D 063030303031FFFFFFAA806042 (9000) ;; GLOBAL PUK

;; --- 4 ---------------------------------------------------------------------------
;; EF LOCAL PIN
A0E0 0001 20 000E 0002 %EF_0012 01000000000100DF00000D %PIN_AC 2F060200 0000000000000000 (9000)
A0E200000D0230303030FFFFFFFF3380ADE5 (9000) ;; LOCAL PIN
A0E200000D0230303030FFFFFFFFAA800F96 (9000) ;; LOCAL PUK

;; --- end -------------------------------------------------------------------------
;; ---------------------------------------------------------------------------------



;; ICCID
A0E00001 20 0000000A 2FE20010 000000 5113DC010000 0FF555 2F060400 0000000000000000 (9000) ;; 00 = TR
A0EA 0000 0A 98102110000072501133 (9000) ; create binary

;; PL
A0E00000 20 0000 0004 2F05 0000 000000 5113DC010000 01F555 2F060200 0000000000000000 (9000) ;; 00 = TR
A0D6 0000 04 FFFFFFFF (9000)

;; EF DIR
A0E0 0001 20 0000 0004 2F00 011E 000000 5113DC0100 30 05F5FF 2F060400 0000000000000000 (9000);; 01 = LF
A0E2 0000 30 6112 4F 10 A0000000871002FF86FF0389FFFFFFFF 5004 5553494D FFFF FFFF FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000) ;; USIM
A0E2 0000 30 611D 4F 10 A0000003431002FF86FF0389FFFFFFFF 5009 556E6976657253494D FFFF FFFF FFFFFFFFFFFFFFFFFFFFFFFFFF (9000) ;; UniverSIM
A0E2 0000 30 6112 4F 10 A0000000871004FF86FF0389FFFFFFFF 5004 4953494D FFFF FFFF FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000) ;; ISIM
A0E2 0000 30 FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)


;; EF ARR
A0E0 FF00 20 0000 000C 2F06 0100 00000011 130C0300 30 05F555 2F060100 0000000000000000 (9000)

A0DC010430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC020430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC030430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC040430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC050430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC060430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC070430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC080430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC090430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC0A0430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC0B0430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC0C0430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)



A0A4 0000 02 3F00 (9F22)

;; -------------------------------------------------------------------------------------
;; create ADF USIM; ADF ID = 7F4F
;; ---
A0E00001 20 00000000 7F4F 2000 01 00FF11 FFFFFF00 000F55FF 2F060300 0000000000000000 (9000)

;; EF ARR
A0E0 FF00 20 0000 0005 6F06 0117 00000011 130C0300 30 05F555 6F060100 0000000000000000 (9000)

A0DC010430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC020430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC030430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC040430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC050430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)

;; EF UST
A0E00000 20 0000000C 6F38 0000 00000051 13DC0100 0005F555 6F060100 0000000000000000 (9000) ;; 00 = TR
A0D600000C FF33FF0F23000C03300C00C0 (9000)

;; EF DELTA
A0E0 0001 20 0000000C 8F92 0000 0000005113DC030000 55F5FF 6F0604 000000000000000000 (9000)
A0EA 0000 0C FFFFFFFFFFE0 FFFFFFFFFFE0 (9000) ; create binary

;; EF PS LOCI
A0E0 0001 20 0000000E 6F73 00%SFI_EF_6F73 0000004913DC03000011F555 6F060400 0000000000000000 (9000)
A0EA 0000 0E FFFFFFFFFFFFFF00F1100000FF01 (9000)

;; EF ACC
A0E0 0001 20 00000002 6F78 00%SFI_EF_6F78 0000004913DC03000015F555 6F060300 0000000000000000 (9000)
A0EA 0000 02 0100 (9000)

;; EF FPLMN
A0E0 0001 20 0000000C 6F7B 00%SFI_EF_6F7B 0000004913DC03000011F555 6F060400 0000000000000000 (9000)
A0EA 0000 0C 24F43072F810FFFFFFFFFFFF (9000)

;; EF LOCI
A0E0 0001 20 0000000B 6F7E 00%SFI_EF_6F7E 0000004913DD070000 11F515 6F060400 0000000000000000 (9000)
A0EA 0000 0B FFFFFFFF62F230FFFE0003 (9000)

;; EF SQN
A0E0 0001 20 00000021 8F91 0100 0000001113DC030006FFF5FF 6F060B00 0000000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 000000000000 (9000)
A0E2000006 00FFFFFFFFFF (9000)

;; KI
A0E00000 20 00000012 8F9A 0000 00000051 13DC0100 0055F555 6F060100 0000000000000000 (9000) ;; 00 = TR
A0D6 0000 12 %KI (9000) ; update binary
;; AUTH_COUNTER
A0E00000 20 00000006 8F9B 0000 00000051 13DC0100 0055F555 6F060100 0000000000000000 (9000) ;; 00 = TR
A0D6 0000 06 0001FFFF2A3F (9000) ; update binary
;; OP
A0E00000 20 00000068 8F9C 0000 00000051 13DC0100 0055F555 6F060100 0000000000000000 (9000) ;; 00 = TR
A0D60000 68 %OP_TYPE %OPC %OP_R1 %OP_R2 %OP_R3 %OP_R4 %OP_R5 %OP_C1 %OP_C2 %OP_C3 %OP_C4 %OP_C5 (9000)



A0A4 0000 02 3F00 (9F22)

;; -------------------------------------------------------------------------------------
;; create ADF ISIM; ADF ID = 7FF2
;; ---
A0E00001 20 00000000 7FF2 2000 03 00FF11 FFFFFF00 000F55FF 2F060300 0000000000000000 (9000)

;; EF ARR
A0E0 FF00 20 0000 0005 6F06 0117 00000011 130C0300 30 05F555 6F060100 0000000000000000 (9000)

A0DC010430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC020430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC030430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC040430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)
A0DC050430 80017F90008402D4E89000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF (9000)

A0A4 0000 02 3F00 (9F22)

;; DF TOLLKIT
A0E0 0001 20 00060009 7FDE1000 00000011 13B00100 000F55FF 2F060100 0000000000000000 (9000)
;; EF Terminal profile
A0E0 0000 20 00000018 6F0A0000 00000051 13DC0100 0015F555 2F060100 0000000000000000 (9000)

.POWER_OFF

;; --------------------------------------------------------------------
;; this is to force AUTH_INIT function, to re-read newly created EF_PIN
.POWER_ON

A0A4 0000 02 3F00 (9F22)
A0C0 0000 22 [0000 XXXX 3F000100 0F55FF0115310308 0500838A838A008A 0000000000000000 0000] (9000)

.POWER_OFF

; now 3G:
;  SELECT
;  GET RESPONSE
;  READ BINARY
;  TERMINAL PROFILE
;  SELECT ADF
.POWER_ON

A020 0001 08 31323334 FFFFFFFF (9000)
A020 0002 08 32323232 FFFFFFFF (9000)

00A4 0004 02 3F 00 (61 24)
00C0 0000 24 [62 22 82 02 78 21 83 02 3F 00 A5 08 80 01 71 83 03 01BF23 8A 01 05 8B 03 2F 06 01 C6 06 90 01 80 83 01 01] (90 00)

00A4 0804 02 2F E2 (61 1E)
00C0 0000 1E [62 1C 82 02 41 21 83 02 2F E2 A5 03 92 01 00 8A 01 05 8B 03 2F 06 04 80 02 00 0A 88 01 80] (90 00)

00B0 0000 0A [98 10 21 10 00 00 72 50 11 33] (90 00)

00A4 0004 02 2F 05 (61 1D)
00C0 0000 1D [62 1B 82 02 41 21 83 02 2F 05 A5 03 92 01 00 8A 01 05 8B 03 2F 06 02 80 02 00 04 88 00] (90 00)

00B0 0000 04 [FF FF FF FF] (90 00)

;8010 0000 1E FF FF FF FF 7F 9D 00 DF BF 00 00 1F E2 00 00 00 C3 F0 00 07 00 01 60 00 51 00 00 00 00 08 (9000)


00A4 0004 02 2F 00 (61 21)
00C0 0000 21 [62 1F 82 05 42 21 00 30 04 83 02 2F 00 A5 03 92 01 00 8A 01 05 8B 03 2F 06 04 80 02 00 C0 88 01 F0] (90 00)

00B2 0104 30 [61 12 4F 10 A0 00 00 00 87 10 02 FF 86 FF 03 89 FF FF FF FF 50 04 55 53 49 4D FFFF FFFF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF] (90 00)
00B2 0204 30 [61 1D 4F 10 A0 00 00 03 43 10 02 FF 86 FF 03 89 FF FF FF FF 50 09 55 6E 69 76 65 72 53 49 4D FFFF FFFF FF FF FF FF FF FF FF FF FF FF FF FF FF] (90 00)
00B2 0304 30 [61 12 4F 10 A0 00 00 00 87 10 04 FF 86 FF 03 89 FF FF FF FF 50 04 49 53 49 4D FFFF FFFF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF] (90 00)
00B2 0404 30 [FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF] (90 00)

;; ---
;; --- select ADF USIM
;; ---
00A4 0404 10 A0000000871002FF86FF0389FFFFFFFF (61 2B)
00C0 0000 2B [62 29 82 02 78 21 84 10 A0 00 00 00 87 10 02 FF 86 FF 03 89 FF FF FF FF 8A 01 05 8B 03 2F 06 03 C6 09 90 01 C0 83 01 01 83 01 81] (90 00)
.POWER_OFF


.POWER_ON
A020 0000 08 528EFE76 503B15DB (9000)

A0EC 0001 01 01 (9000) ;; CONFIG: map CHV1 to GLOBAL PIN
A0EC 0002 01 81 (9000) ;; CONFIG: map CHV2 to LOCAL PIN
A0EC 0003 01 01 (9000) ;; CONFIG: map ADM


00A4 0004 02 3F00 (61XX)
0020 0001 08 30303030 FFFFFFFF (9000) ;; GPIN
A020 0001 08 30303030 FFFFFFFF (9000) ;; PIN1

.POWER_OFF


